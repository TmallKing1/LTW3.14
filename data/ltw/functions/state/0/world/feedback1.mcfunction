# 步数、当前格信息、奖励
tellraw @s ["",{"text":"\n------  ","color":"aqua","bold":true},{"text": "世界模式结算信息","color": "aqua","bold": true},{"text": " ------\n ","color": "aqua","bold": true}]
scoreboard players operation $progress_part1 mem = @s world_feedback_step
scoreboard players operation $progress_part1 mem /= #100 mem
scoreboard players operation $progress_part2 mem = @s world_feedback_step
scoreboard players operation $progress_part2 mem /= #10 mem
scoreboard players operation $progress_part2 mem %= #10 mem
scoreboard players operation $progress_part3 mem = @s world_feedback_step
scoreboard players operation $progress_part3 mem %= #10 mem
tellraw @s ["  ",{"text": "前进步数 > ","color": "yellow"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"}]

execute store result score $current_stage_type mem run function ltw:state/0/world/get_current_type
execute store result score $current_stage_step mem run function ltw:state/0/world/get_current_step
scoreboard players operation $progress_temp mem = $current_stage_step mem
scoreboard players operation $progress_temp mem *= #100 mem
scoreboard players operation $progress_temp mem -= @s world_progress
scoreboard players operation $progress_part1 mem = $progress_temp mem
scoreboard players operation $progress_part1 mem /= #100 mem
scoreboard players operation $progress_part2 mem = $progress_temp mem
scoreboard players operation $progress_part2 mem /= #10 mem
scoreboard players operation $progress_part2 mem %= #10 mem
scoreboard players operation $progress_part3 mem = $progress_temp mem
scoreboard players operation $progress_part3 mem %= #10 mem
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches 0 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches 1 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" 双倍格 ","color":"gold"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches 2 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" 随机格 ","color":"dark_purple"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches 3 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" +2 符咒 ","color":"green"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches -1 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" 限制 [改版模式] ","color":"red"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches -2 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" 限制 [经典模式] ","color":"red"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute unless score @s world_stage >= $world_stage_max mem if score $current_stage_type mem matches -3 run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "red"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"},{"text":" 限制 [逆转模式] ","color":"red"},{"text":" 剩余：","color":"white"},{"score":{"name":"$progress_part1","objective":"mem"},"color":"red"},{"text":".","color":"red"},{"score":{"name":"$progress_part2","objective":"mem"},"color":"red"},{"score":{"name":"$progress_part3","objective":"mem"},"color":"red"},{"text":" / ","color":"gray"},{"score":{"name":"$current_stage_step","objective":"mem"},"color":"yellow"}]
execute if score @s world_stage >= $world_stage_max mem run tellraw @s ["  ",{"text": "当前格 > ","color": "green"},{"score":{"name": "@s","objective": "world_stage"},"color": "green"},{"text":" / ","color":"gray"},{"score":{"name": "$world_stage_max","objective": "mem"},"color": "white"}]
execute if score @s world_feedback_reward matches 1.. run tellraw @s ["  ",{"text": "获得金粒 > ","color": "gold"},{"score":{"name": "@s","objective": "world_feedback_reward"},"color": "gold"}]
tellraw @a ""